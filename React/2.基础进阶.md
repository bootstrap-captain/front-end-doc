# 脚手架

## 1. 构建步骤

```bash
# 1. 全局安装
npm install -g create-react-app

# 2. 进入目录，创建好自己的项目
create-react-app erick-demo
```

## 2. 项目解构

![image-20240602154808599](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20240602154808599.png)

### 2.1 index.html

- SPA: single page application, 单页面应用

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <!--%PUBLIC_URL%: 代表public文件夹的路径-->
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico"/>
    <title>Erick React</title>
</head>
<body>
<noscript>You need to enable JavaScript to run this app.</noscript>
<!--主容器：只会放一个组件-->
<div id="root"></div>
</body>
</html>
```

### 2.2 index.js

- 入口文件，将APP组件渲染到页面

```js
import React from 'react';
import ReactDOM from 'react-dom/client';
import './index.css';
import App from './App';

/*入口文件*/
const root = ReactDOM.createRoot(document.getElementById('root'));
/* 将APP组件渲染到页面*/
root.render(
    /*检查React代码不合理的地方：比如react过时的api*/
  <React.StrictMode>
    <App />
  </React.StrictMode>
);
```

### 2.3 app.js

- 导出APP组件

```js
import logo from './logo.svg';
import './App.css';

function App() {
    return (<div className="App">
        <header className="App-header">
            <img src={logo} className="App-logo" alt="logo"/>
            <p>
                Edit <code>src/App.js</code> and save to reload.
            </p>
            <a
                className="App-link"
                href="https://reactjs.org"
                target="_blank"
                rel="noopener noreferrer"
            >
                Learn React
            </a>
        </header>
    </div>);
}

export default App;
```

## 3. 入门Demo

```bash
# 具体的模块，建在src/component/xxx中
- jsx：模块组件
- js：js功能代码
- css：样式代码

# 导出的模块，可以在App.js中统一配置
```

![image-20240602164303445](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20240602164303445.png)

### 3.1 jsx

```jsx
import './Citi.css';
/*函数式组件*/
export default function Citi() {
    return (
        <div className="citiTitle">
            CITI BANK
        </div>);
}
```

### 3.2 css

```css
.citiTitle {
    background-color: aqua;
}
```

### 3.3 app.js

```js
/*函数式组件*/
import Citi from "./component/citi/Citi";
import NikeCompany from "./component/nike/Nike";

/*入口的app.js,里面包含多个不同的组件*/
export default function App() {
    return (
        <div>
            <Citi/>
            <NikeCompany/>
        </div>);
}
```

# Demo练习

## 1. TODO List

```bash
# 1. 拆分组件
- 拆分页面，抽取组件

# 2. 实现静态组件
- 使用组件，实现静态页面效果

# 3. 动态显示初始化数据
    - 数据类型
    - 数据名称
    - 保存在哪个组件
    
# 4. 交互
- 绑定事件监听
```

## 2. 组件通信

- 父组件给子组件通信好说
- 兄弟组件不好直接传递

# 网络代理

![image-20240603095750770](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20240603095750770.png)

## 1. 配置方式一

- 在package.json中添加，React启动后，就会在3000端口启动一个Proxy，后序请求就会将数据发送到Server端的8080端口
- 3000端口只要没有的资源，都会去通过proxy找8080要
- 只能配置一个后台的端口

```bash
"proxy": "http://localhost:8080"
```

![image-20240603102230316](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20240603102230316.png)

```jsx
import React from "react";
import axios from "axios";

export default class App extends React.Component {

    getInfo = () => {
        axios({
            method: 'GET',
            url: 'http://localhost:3000/erick/sleep'
        }).then(value => {
            console.log(value.data);
        }).catch(reason => {
            console.log(reason)
        })
    }

    render() {
        return (
            <div>
                <button onClick={this.getInfo}>点击获取数据</button>
            </div>)
    }
}
```

## 2. 配置方式二

- 在React的src目录下，建一个名字必须为setupProxy.js的文件
- 请求不同服务，不同服务的不同转发
- React在执行时，会自动使用配置的setupProxy.js配置的规则

### setupProxy.js

```js
const {createProxyMiddleware} = require('http-proxy-middleware');

module.exports = function (app) {
    app.use(
        '/firstserver',/*请求如果带这个前缀*/
        createProxyMiddleware({
            target: 'http://localhost:8080', // 目标服务器地址
            changeOrigin: true,              // 是否改变源地址
            pathRewrite: {
                '^/firstserver': '',                   // 重写路径
            },
        })
    );

    app.use(
        '/secondserver',
        createProxyMiddleware({
            target: 'http://localhost:9090', // 目标服务器地址
            changeOrigin: true,              // 是否改变源地址
            pathRewrite: {
                '^/secondserver': '',                   // 重写路径
            },
        })
    );
};
```

```jsx
import React from "react";
import axios from "axios";

export default class App extends React.Component {

    getFromFirstServer = () => {
        axios({
            method: 'GET',
            url: 'http://localhost:3000/firstserver/erick/sleep'
        }).then(value => {
            console.log(value.data);
        }).catch(reason => {
            console.log(reason)
        })
    }

    getFromSecondServer = () => {
        axios({
            method: 'GET',
            /*带前缀*/
            url: 'http://localhost:3000/secondserver/erick/sleep'
        }).then(value => {
            console.log(value.data);
        }).catch(reason => {
            console.log(reason)
        })
    }

    render() {
        return (
            <div>
                <button onClick={this.getFromFirstServer}>第一个服务</button>
                <button onClick={this.getFromSecondServer}>第二个服务</button>
            </div>)
    }
}
```

# 路由

## 1. SPA

- Single Page Application：单页面Web应用
- 整个页面只有一个完整的页面
- 点击页面中的链接，不会刷新页面，只会做页面的局部更新
- 数据都需要通过Ajax请求获取，并在前端异步展现
- 单页面，多组件

## 2. 路由

- 一个路由就是一个映射关系(key:value)
- key为路径，value可能是function或者component

```bash
# 浏览器路由
- value是component，用于展示页面内容

# 注册路由
- <Route path='/test' component={Test}>

# 工作过程
- 当浏览器的path变为/test时，当前路由组件就会变成Test组件
```

## 3. 基本Demo

- react-router-dom: React的一个插件，是用来给Web用的
- 专门用来实现一个SPA应用
- 基于React的项目，基本都会用到此库

```bash
# "react-router-dom": "^5.3.4"
npm i react-router-dom@5
```

### 写法一

#### index.js

```js
import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';

/*入口文件*/
const root = ReactDOM.createRoot(document.getElementById('root'));
/* 将APP组件渲染到页面*/
root.render(
    /*检查React代码不合理的地方：比如react过时的api*/
  <React.StrictMode>
    <App />
  </React.StrictMode>
);
```

#### app.js

```js
import React from "react";
import {BrowserRouter, Link, Route} from "react-router-dom";
import {AboutComponent} from "./component/About/AboutComponent";
import {HomeComponent} from "./component/Home/HomeComponent";


export default class App extends React.Component {
    render() {
        return (
            <div>
                <div>
                    公共部分
                </div>
                {/*整个应用，需要用一个BrowserRouter来管理*/}
                <BrowserRouter>
                    {/*1. 编写路由链接*/}
                    {/*点击两个模块时，切换浏览器url：
                    http://localhost:3000/about
                    http://localhost:3000/home*/}
                    <Link to="/about">About</Link><br/>
                    <Link to="/home">Home</Link>

                    {/*2. 依靠路由链接，实现组件切换*/}
                    <Route path="/about" component={AboutComponent}></Route>
                    <Route path="/home" component={HomeComponent}></Route>

                    {/*如果要添加其他路由，则在里面继续添加*/}
                </BrowserRouter>
            </div>)
    }
}
```

#### AboutComponent.jsx

```jsx
import {Component} from "react";

export class AboutComponent extends Component {
    render() {
        return (
            <div>
                我是About
            </div>
        )
    }
}
```

#### HomeComponent.jsx

```jsx
import {Component} from "react";

export class HomeComponent extends Component {
    render() {
        return (
            <div>
                我是Home
            </div>
        )
    }
}
```

### 写法二

- 用\<BrowserRouter>把整个APP包起来

#### index.js

```js
import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';
import {BrowserRouter} from "react-router-dom";

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(
    <React.StrictMode>
        {/*用BrowserRouter把App组件包裹起来*/}
        <BrowserRouter>
            <App/>
        </BrowserRouter>
    </React.StrictMode>
);
```

#### app.js

```js
import React from "react";
import {Link, Route} from "react-router-dom";
import {AboutComponent} from "./component/About/AboutComponent";
import {HomeComponent} from "./component/Home/HomeComponent";

export default class App extends React.Component {
    render() {
        return (
            <div>
                <div>
                    公共部分
                </div>
                {/*1. 编写路由链接*/}
                {/*点击两个模块时，切换浏览器url：
                    http://localhost:3000/about
                    http://localhost:3000/home*/}
                <Link to="/about">About</Link><br/>
                <Link to="/home">Home</Link>

                {/*2. 依靠路由链接，实现组件切换*/}
                <Route path="/about" component={AboutComponent}></Route>
                <Route path="/home" component={HomeComponent}></Route>

                {/*如果要添加其他路由，则在里面继续添加*/}
            </div>)
    }
}
```

